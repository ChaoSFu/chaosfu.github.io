# AI量价分析功能说明

## 功能概述

基于 **OpenAI GPT-4o-mini** 模型的智能量价分析功能，可对主要指数进行专业的技术分析和投资建议。

## 使用的AI模型

- **模型**: GPT-4o-mini
- **特点**: OpenAI的高性价比模型，适合大量API调用
- **成本**: 约为GPT-4的1/10，适合频繁使用

## 功能特性

### 1. 公共AI配置（页面顶部）

在页面顶部有一个紫色渐变的AI分析区域，点击"⚙️ API配置"按钮可以：
- 配置你的OpenAI API密钥
- 密钥仅保存在浏览器本地（localStorage）
- 不会上传到任何服务器
- 完全隐私安全

### 2. 一键批量分析

在"主要指数看板"标题旁边有"✨ 一键生成AI分析"按钮，点击后：
- 自动分析所有6个主要指数（中证100/上证50/沪深300/中证500/中证1000/中证2000）
- 串行执行，避免API速率限制（每个指数之间间隔1秒）
- 显示实时进度（例如：🤔 分析中 3/6...）
- 完成后按钮显示"✅ 分析完成"

### 3. 分析内容

每个指数的AI分析包括：

1. **量价关系分析**
   - 结合成交额和涨跌幅的关系
   - 判断放量上涨、缩量下跌等技术形态

2. **市场阶段判断**
   - 根据指数特征（超大盘/大盘/中盘/小盘/微盘）
   - 判断当前处于什么市场阶段

3. **投资建议**
   - 简明扼要的2-3句话建议
   - 基于量价分析和市场阶段给出操作建议

## 获取OpenAI API密钥

1. 访问 [OpenAI Platform](https://platform.openai.com/)
2. 注册/登录账号
3. 进入 API Keys 页面
4. 创建新的API密钥
5. 复制密钥（格式：sk-...）
6. 在本网站顶部点击"⚙️ API配置"按钮粘贴

## 成本估算

使用 GPT-4o-mini 模型：
- 输入：约150 tokens/次
- 输出：约200 tokens/次
- 总计：约350 tokens/次

6个指数一键分析：
- 总tokens：约2100 tokens
- 成本：约 $0.001 USD（人民币约0.007元）

## 注意事项

1. **API密钥安全**
   - 不要分享你的API密钥
   - 定期更换密钥
   - 如果泄露立即删除旧密钥

2. **速率限制**
   - 批量分析使用串行执行，自动避免速率限制
   - 每个请求之间间隔1秒
   - 如遇到错误，请稍后重试

3. **成本控制**
   - GPT-4o-mini成本很低，但仍建议合理使用
   - 可以在OpenAI控制台设置使用限额
   - 监控API使用情况

4. **分析结果**
   - AI分析仅供参考，不构成投资建议
   - 请结合其他信息综合判断
   - 投资有风险，决策需谨慎

## 故障排查

**问题：点击"一键生成AI分析"没有反应**
- 解决：检查是否已配置API密钥
- 确认：页面顶部点击"⚙️ API配置"查看

**问题：分析失败，显示"API请求失败"**
- 解决1：检查API密钥是否正确
- 解决2：检查OpenAI账户余额
- 解决3：检查网络连接

**问题：分析结果不显示**
- 解决：刷新页面重试
- 确认：打开浏览器控制台查看错误信息

## 技术实现

- **前端**: 纯JavaScript，无后端服务
- **API调用**: 直接从浏览器调用OpenAI API
- **数据存储**: localStorage（仅保存API密钥）
- **安全性**: HTTPS + 本地存储，不经过第三方服务器

## 更新日志

### 2025-11-10
- ✅ AI配置移至页面顶部作为公共能力
- ✅ 新增一键批量分析所有指数功能
- ✅ 使用GPT-4o-mini模型，降低成本
- ✅ 串行执行避免API速率限制
- ✅ 实时显示分析进度

## 反馈与建议

如有问题或建议，欢迎提Issue或PR。
